#- alias: 'track sensor state of Jay Room Locator'
#  trigger:
#    platform: mqtt
#    topic: owntracks/jays7/galaxy s7/event
#  condition:
#    condition: or
#    conditions:
#    - condition: template
#      value_template: "{{ trigger.payload_json['desc'] == '-den' }}"
#    - condition: template
#      value_template: "{{ trigger.payload_json['desc'] == '-master bedroom' }}"
#    - condition: template
#      value_template: "{{ trigger.payload_json['desc'] == '-basement' }}"
#  action:
#    service_template: "input_boolean.turn_{{ 'on' if trigger.payload_json['event'] == 'enter' else 'off' }}"
#    data_template:
#      entity_id: "input_boolean.jay_phone_{{ 'den' if trigger.payload_json['desc'] == '-den' else 'master' if trigger.payload_json['desc'] == '-master bedroom' else 'basement' }}"
- alias: 'track sensor state of Jay WiFi Locator'
  trigger:
    platform: state
    entity_id: sensor.jay_wifi_locator
  action:
    - service: input_boolean.turn_off
      data_template:
        entity_id: "input_boolean.jay_phone_{{ 'den' if trigger.from_state.state == 'den' else 'master' if trigger.from_state.state == 'master bedroom' else 'basement' if trigger.from_state.state == 'basement'
                    else 'kitchen' if trigger.from_state.state == 'kitchen' else 'lr' if trigger.from_state.state == 'livingroom' else 'gym' if trigger.from_state.state == 'gym' }}"
    - service: input_boolean.turn_on
      data_template:
        entity_id: "input_boolean.jay_phone_{{ 'den' if trigger.to_state.state == 'den' else 'master' if trigger.to_state.state == 'master bedroom' else 'basement' if trigger.to_state.state == 'basement'
                    else 'kitchen' if trigger.to_state.state == 'kitchen' else 'lr' if trigger.to_state.state == 'livingroom' else 'gym' if trigger.to_state.state == 'gym' }}"
    - service: input_select.select_option
      data_template:
        entity_id: input_select.jay_room_tracker
        option: "{{ 'den' if trigger.to_state.state == 'den' else 'master' if trigger.to_state.state == 'master bedroom' else 'basement' if trigger.to_state.state == 'basement'
                else 'kitchen' if trigger.to_state.state == 'kitchen' else 'livingroom' if trigger.to_state.state == 'livingroom' else 'gym' if trigger.to_state.state == 'gym' }}"
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.jay_home
#    - service: tts.google_say
#      entity_id: media_player.living_room
#      data_template:
#        message: "Jay moved rooms to {{ trigger.to_state.state ~ ' ' ~ trigger.for ~ ' seconds ago' }}"

- alias: 'Lily Away'
  condition:
    condition: state
    entity_id: input_boolean.lily_home
    state: 'on'
  trigger:
    - platform: state
      entity_id: device_tracker.cc088d3faa4b
      to: 'not_home'
    - platform: state
      entity_id: device_tracker.020fb53faa4b
      to: 'not_home'
  action:
     service: input_boolean.turn_off
     data:
       entity_id: input_boolean.lily_home

- alias: 'Lily Home'
  condition:
    condition: state
    entity_id: input_boolean.lily_home
    state: 'off'
  trigger:
    - platform: state
      entity_id: device_tracker.bca920aed406
      to: 'home'
    - platform: state
      entity_id: device_tracker.020fb5aed406
      to: 'home'
  action:
     service: input_boolean.turn_on
     data:
       entity_id: input_boolean.lily_home

- alias: 'Madeline Away'
  condition:
    condition: state
    entity_id: input_boolean.maddie_home
    state: 'on'
  trigger:
    - platform: state
      entity_id: device_tracker.020fb572f640
      to: 'not_home'
    - platform: state
      entity_id: device_tracker.bc9fef72f640
      to: 'not_home'
  action:
     service: input_boolean.turn_off
     entity_id: input_boolean.maddie_home

- alias: 'Madeline Home'
  condition:
    condition: state
    entity_id: input_boolean.maddie_home
    state: 'off'
  trigger:
    - platform: state
      entity_id: device_tracker.020fb572f640
      to: 'home'
    - platform: state
      entity_id: device_tracker.bc9fef72f640
      to: 'home'
  action:
     service: input_boolean.turn_on
     entity_id: input_boolean.maddie_home

- alias: 'Jay Home'
  condition:
    condition: state
    entity_id: input_boolean.jay_home
    state: 'off'
  trigger:
    platform: state
    entity_id: device_tracker.jays7_galaxy_s7
    to: 'home'
  action:
     service: input_boolean.turn_on
     entity_id: input_boolean.jay_home

- alias: 'Jay Not Home'
  condition:
    condition: state
    entity_id: input_boolean.jay_home
    state: 'on'
  trigger:
    platform: state
    entity_id: device_tracker.jays7_galaxy_s7
    to: 'not_home'
  action:
     service: input_boolean.turn_off
     entity_id: input_boolean.jay_home
